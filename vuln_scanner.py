import port_scanner
import port_scanner as ps
import pyfiglet
from datetime import datetime

target_ip = input("[+] Enter the target ip to scan the vulnerability: ")
port_number = int(input("[+] Enter the number of ports you want to scan( 500 mean first 500 ports): "))
vuln_file = input("[+] Enter path to the file with vulnerable softwares list: ")
print('\n')

target = port_scanner.PortScan(target_ip,port_number)
target.scan()

with open(vuln_file, 'r') as file:
    count = 0
    for banner in target.banners:
        file.seek(0)
        for line in file.readlines():
            if line.strip() in banner:
                print('[!!] VULNERABLE BANNER: "' + banner +'" ON PORT: ' + str(target.open_ports))

        count += 1
